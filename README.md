# Occam-Messenger
The SIMPLEST and most reliable messenger available.

Кто не знает - Бритва Оккама - это правило, которое гласит "Не вводи новых сущностей без необходимости".

Данный проект называется Оккам потому что для передачи сообщений не используется какой-либо мессенджерский протокол (AIM, XMPP и т.п.)
Согласитесь, это здорово, потому что не надо тратить время на их изучение, искать готовые NuGet пакеты и разбираться еще и в них.
Внезапно (!) оказалось, что для практически мгновенной передачи сообщений можно использовать общие папки (shared folders) облачных сервисов типа DropBox. 
Все что нужно - это зарегистрироваться в DropBox (или его конкуренте), скачать Windows клиент, создать shared folder и послать приглашение абоненту. Абонент должен приглашение принять, если у него еще нет DropBox - то зарегистрироваться и установить Windows клиента. В результате у вас и у абонента появится физическая папка с магическим свойством - стоит положить в нее файл, как тут же он появляется в папке абонента и наоборот. DropBox синхронизирует с задержкой 5-6 сек. Это хорошо, но долго. MS OneDrive синхронизирует примерно за 3 сек., а pCloud за 1.5 и это пока лучшее из того что я протестировал.
После этого передача сообщения сводится к простому копированию файла с этим сообщением в общую папку.
Получить сообщение очень просто - нужно по таймеру опрашивать эту папку и если там что-то появилось - читать файл и извлекать из него сообщение. Ну и удалять файл после этого чтобы не захламлять окружающую среду.
Кроме собственно сообщений нужно передавать статусы. Это делается с помощью передачи служебных сообщений (команд). Отличать сообщение от команды можно простым делимитером - например точкой с запятой.
В данной программе в файле может быть либо текст, либо команда. Первый символ в файле либо T (text) либо С (command)
Дадее идет точка с запятой и тело сообщения.
Для текста - это собственно текст сообщения
Для команды - это имя команды и через двоеточие параметры команды
Например Status:On
Для того чтобы каждый из абонентов читал только сообщения, адресованные ему, примем соглашение что файлы от первого ко второму будут иметь имя вида P_<Number> (P = Primary), а обратно будут иметь имя вида S_<Number>  (S = Secondary).

Для передачи файлов используется та же общая папка.
Файл будет иметь произвольное имя.
Чтобы послать файл абонент копирует его в папку и шлет служебное сообщение вида 
C;F:<имя файла>
Получатель получает служебное сообщение и ждет когда в папке образуется переданный файл.
После его появления он перемещает этот файл в предопределенную папку и все.

Из сторонних пакетов используется только SQLite (для хранения данных о каналах) и NAudio для проигрывания аудиофайлов.

Кроме передачи состояний (Здесь/Отключен) и передачи текста, файлов и голосовых файлов в программе ничего нет.
Вернее есть еще режим конференции.

Больше никаких свистелок и перделок.
Хотите - добавляйте.

Удачи.
